# Timeout API (in millisecondi)
api_timeouts:
  submit_form: 30000
  generate_questions: 60000
  submit_answers: 30000
  generate_draft: 120000
  generate_outline: 120000
  download_pdf: 300000

# Retry logic
retry:
  chapter_generation:
    max_retries: 2
    min_chapter_length: 50  # caratteri

# Validazione
validation:
  min_chapter_length: 50  # caratteri
  words_per_page: 250
  toc_chapters_per_page: 30

# Polling frontend (in millisecondi)
frontend:
  polling_interval: 2000
  polling_interval_critique: 5000  # più lento quando in attesa critica

# Metriche e stima tempo
time_estimation:
  min_chapters_for_reliable_avg: 3
  use_session_avg_if_available: true
  fallback_seconds_per_chapter: 45  # Tempo medio per capitolo quando non ci sono dati storici

# Configurazione modelli LLM
llm_models:
  max_output_tokens:
    gemini_2_5_flash: 8192
    default: 65536  # Per tutti gli altri modelli (Pro 2.5, Flash 3, Pro 3)

# Generazione copertina
cover_generation:
  aspect_ratio: "2:3"  # Ratio per immagini copertina (adatto a PDF A4)

# Configurazione temperature per agenti
# Se non specificata, viene applicata la regola basata sulla versione del modello:
# - Gemini 2.5 (flash o pro): temperatura 0.0
# - Gemini 3.0 (flash o pro): temperatura 1.0
temperature:
  agents:
    # draft_generator: 0.7  # Esempio: scommentare per override
    # outline_generator: 0.7  # Esempio: scommentare per override
    # writer_generator: 0.0  # Esempio: scommentare per override
    # question_generator: 0.7  # Esempio: scommentare per override
    # literary_critic è configurato in literary_critic.yaml

# Stima costi generazione libro
# NOTA: Aggiornare i costi con i valori reali da Google Gemini API pricing
cost_estimation:
  tokens_per_page: 350  # Numero di token stimati per pagina
  currency: "EUR"  # Valuta di visualizzazione
  exchange_rate_usd_to_eur: 0.92  # Tasso di cambio USD->EUR (aggiornare se necessario)
  
  # Costi per modello (per 1 milione di token)
  # NOTA: Questi sono valori di esempio - AGGIORNARE con i costi reali da Google
  model_costs:
    gemini-2.5-flash:
      input_cost_per_million: 0.30   # USD per 1M token input
      output_cost_per_million: 2.50   # USD per 1M token output
    gemini-2.5-pro:
      input_cost_per_million: 1.25    # USD per 1M token input
      output_cost_per_million: 10.00   # USD per 1M token output
    gemini-3-flash-preview:
      input_cost_per_million: 0.50    # USD per 1M token input
      output_cost_per_million: 3.00   # USD per 1M token output
    gemini-3-pro-preview:
      input_cost_per_million: 2.00   # USD per 1M token input
      output_cost_per_million: 12.00   # USD per 1M token output
    default:
      input_cost_per_million: 1.00    # USD per 1M token input (fallback)
      output_cost_per_million: 3.00   # USD per 1M token output (fallback)
  
  # Costo per generazione immagine copertina
  # NOTA: Le immagini hanno pricing diverso - AGGIORNARE con costo reale
  image_generation_cost: 0.02  # USD per immagine copertina
  
  # Stime token per le varie fasi (usati per calcolo)
  token_estimates:
    draft:
      input_base: 800   # Token base per input bozza (trama + form_data)
      output_per_page: 12  # Token output per pagina di bozza generata (bozza è più breve)
    outline:
      input_base: 3000  # Token input per outline (bozza validata)
      output_base: 2000  # Token output outline (Markdown)
    chapter:
      context_base: 8000  # Token base contesto per capitolo (draft + outline + form_data + system_prompt)
    critique:
      input_multiplier: 1.2  # Multiplicatore pagine per input PDF (considera formato)
      output_base: 1200  # Token output critica JSON
